# Diagrama Entidade-Relacionamento - Sistema de Oficina Mec√¢nica

## üìä Modelo ER em Mermaid

```mermaid
erDiagram
    CLIENTE {
        int id_cliente PK
        string nome
        string cpf_cnpj
        string telefone
        string email
        string endereco_rua
        string endereco_numero
        string endereco_cidade
        string endereco_estado
        string endereco_cep
        enum tipo_cliente
        date data_cadastro
        boolean status_ativo
    }
    
    VEICULO {
        int id_veiculo PK
        string placa UK
        string marca
        string modelo
        int ano_fabricacao
        int ano_modelo
        string cor
        int quilometragem
        string numero_chassi
        enum combustivel
        int id_cliente FK
        date data_cadastro
    }
    
    MECANICO {
        int codigo_mecanico PK
        string nome
        string cpf UK
        string telefone
        string endereco_rua
        string endereco_numero
        string endereco_cidade
        string endereco_estado
        string endereco_cep
        enum especialidade
        decimal salario
        date data_contratacao
        boolean status_ativo
    }
    
    EQUIPE {
        int id_equipe PK
        string nome_equipe
        string descricao
        date data_formacao
        int lider_equipe FK
        boolean status_ativa
    }
    
    ORDEM_DE_SERVICO {
        int numero_os PK
        date data_emissao
        date data_prevista_conclusao
        date data_conclusao_real
        decimal valor_mao_obra
        decimal valor_pecas
        decimal valor_total
        text descricao_problema
        text observacoes
        enum status_os
        boolean autorizacao_cliente
        date data_autorizacao
        int id_veiculo FK
        int id_equipe FK
    }
    
    SERVICO {
        int id_servico PK
        string nome_servico
        text descricao
        string categoria
        decimal tempo_estimado_horas
        decimal valor_referencia
        int complexidade
        boolean requer_especializacao
        boolean status_ativo
    }
    
    PECA {
        int id_peca PK
        string codigo_peca UK
        string nome_peca
        text descricao
        string marca
        string modelo_compativel
        decimal valor_unitario
        int estoque_atual
        int estoque_minimo
        string unidade_medida
        string localizacao_estoque
        boolean status_ativo
    }
    
    TABELA_REFERENCIA_MAO_OBRA {
        int id_referencia PK
        string tipo_servico
        string especialidade_requerida
        decimal valor_hora_base
        decimal multiplicador_complexidade
        decimal tempo_padrao_horas
        date data_vigencia_inicio
        date data_vigencia_fim
        boolean status_ativo
    }
    
    MECANICO_EQUIPE {
        int id_mecanico PK_FK
        int id_equipe PK_FK
        date data_entrada_equipe
        date data_saida_equipe
        string funcao_na_equipe
        boolean status_ativo
    }
    
    OS_SERVICO {
        int numero_os PK_FK
        int id_servico PK_FK
        int quantidade
        decimal valor_unitario
        decimal valor_total
        decimal tempo_executado_horas
        text observacoes
        enum status_execucao
        int mecanico_responsavel FK
    }
    
    OS_PECA {
        int numero_os PK_FK
        int id_peca PK_FK
        int quantidade_utilizada
        decimal valor_unitario
        decimal valor_total
        date data_aplicacao
        int mecanico_aplicador FK
        text observacoes
    }
    
    %% Relacionamentos 1:N
    CLIENTE ||--o{ VEICULO : "possui"
    VEICULO ||--o{ ORDEM_DE_SERVICO : "gera"
    EQUIPE ||--o{ ORDEM_DE_SERVICO : "atende"
    MECANICO ||--o{ EQUIPE : "lidera"
    
    %% Relacionamentos N:M atrav√©s de entidades associativas
    MECANICO ||--o{ MECANICO_EQUIPE : "participa"
    EQUIPE ||--o{ MECANICO_EQUIPE : "composta_por"
    
    ORDEM_DE_SERVICO ||--o{ OS_SERVICO : "cont√©m"
    SERVICO ||--o{ OS_SERVICO : "executado_em"
    
    ORDEM_DE_SERVICO ||--o{ OS_PECA : "utiliza"
    PECA ||--o{ OS_PECA : "consumida_em"
    
    %% Relacionamentos adicionais
    MECANICO ||--o{ OS_SERVICO : "executa"
    MECANICO ||--o{ OS_PECA : "aplica"
    
    %% Relacionamento 1:1
    SERVICO ||--|| TABELA_REFERENCIA_MAO_OBRA : "referencia"
```

## üìã Legendas e Explica√ß√µes

### S√≠mbolos Utilizados
- **PK** = Primary Key (Chave Prim√°ria)
- **FK** = Foreign Key (Chave Estrangeira)
- **UK** = Unique Key (Chave √önica)
- **PK_FK** = Chave que √© tanto Prim√°ria quanto Estrangeira

### Cardinalidades
- **||--o{** = Relacionamento 1:N (Um para Muitos)
- **||--||** = Relacionamento 1:1 (Um para Um)
- **}o--o{** = Relacionamento N:M (Muitos para Muitos)

### Status/Enums Definidos

#### Status da Ordem de Servi√ßo
- `Pendente`: OS criada, aguardando autoriza√ß√£o
- `Aprovada`: Cliente autorizou, aguardando in√≠cio
- `Em Andamento`: Servi√ßos sendo executados
- `Conclu√≠da`: Todos os servi√ßos finalizados
- `Cancelada`: OS cancelada pelo cliente ou oficina

#### Especialidades dos Mec√¢nicos
- `Motor`: Especialista em motores
- `Suspens√£o`: Especialista em sistema de suspens√£o
- `Freios`: Especialista em sistema de freios
- `El√©trica`: Especialista em parte el√©trica
- `Pintura`: Especialista em pintura automotiva
- `Funilaria`: Especialista em funilaria
- `Ar Condicionado`: Especialista em climatiza√ß√£o

#### Tipos de Cliente
- `Pessoa F√≠sica`: Cliente individual
- `Pessoa Jur√≠dica`: Empresa/organiza√ß√£o

#### Tipos de Combust√≠vel
- `Gasolina`, `√Ålcool`, `Flex`, `Diesel`, `GNV`, `El√©trico`, `H√≠brido`

### Fluxo do Processo

1. **Cliente** traz **Ve√≠culo** para a oficina
2. **Equipe** de **Mec√¢nicos** avalia o ve√≠culo
3. √â criada uma **Ordem de Servi√ßo** com os **Servi√ßos** necess√°rios
4. S√£o identificadas as **Pe√ßas** necess√°rias
5. Cliente autoriza a execu√ß√£o
6. **Mec√¢nicos** executam os **Servi√ßos** e aplicam as **Pe√ßas**
7. OS √© finalizada com todos os valores calculados

### Integridade Referencial

- Todo **Ve√≠culo** deve pertencer a um **Cliente**
- Toda **Ordem de Servi√ßo** deve referenciar um **Ve√≠culo** e uma **Equipe**
- **Mec√¢nicos** podem participar de m√∫ltiplas **Equipes**
- Uma **OS** pode conter m√∫ltiplos **Servi√ßos** e **Pe√ßas**
- Valores s√£o calculados automaticamente baseados nas tabelas de refer√™ncia

## üîç Observa√ß√µes T√©cnicas

### Otimiza√ß√µes Recomendadas
- √çndices em campos de busca frequente (placa, CPF, data_emissao)
- Particionamento da tabela OS por data para grandes volumes
- Views para relat√≥rios complexos
- Triggers para manuten√ß√£o de estoque e c√°lculos autom√°ticos

### Extens√µes Futuras
- Sistema de agendamento
- Controle de garantias
- Hist√≥rico de manuten√ß√µes
- Integra√ß√£o com fornecedores
- Sistema de fidelidade para clientes
- Controle financeiro e faturamento

---

Este diagrama serve como refer√™ncia visual para o desenvolvimento e implementa√ß√£o do banco de dados da oficina mec√¢nica.